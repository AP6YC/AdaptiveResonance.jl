<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>ART Options Example · AdaptiveResonance.jl</title><script data-outdated-warner src="../../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.044/juliamono.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../../assets/documenter.js"></script><script src="../../../siteinfo.js"></script><script src="../../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../../assets/themeswap.js"></script><link href="../../../assets/favicon.ico" rel="icon" type="image/x-icon"/><link href="../../../democards/gridtheme.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../../"><img src="../../../assets/logo.png" alt="AdaptiveResonance.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../../">AdaptiveResonance.jl</a></span></div><form class="docs-search" action="../../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../../">Home</a></li><li><span class="tocitem">Getting Started</span><ul><li><a class="tocitem" href="../../../getting-started/whatisart/">Background</a></li><li><a class="tocitem" href="../../../getting-started/basic-example/">Basic Example</a></li></ul></li><li><span class="tocitem">Tutorial</span><ul><li><a class="tocitem" href="../../../man/guide/">Guide</a></li><li><a class="tocitem" href="../../">Examples</a></li><li><a class="tocitem" href="../../../man/modules/">Modules</a></li><li><a class="tocitem" href="../../../man/contributing/">Contributing</a></li><li><a class="tocitem" href="../../../man/full-index/">Index</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>ART Options Example</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>ART Options Example</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/AP6YC/AdaptiveResonance.jl/blob/master/docs/examples/adaptive_resonance/options.jl" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="options"><a class="docs-heading-anchor" href="#options">ART Options Example</a><a id="options-1"></a><a class="docs-heading-anchor-permalink" href="#options" title="Permalink"></a></h1><p><a href="../options.jl"><img src="https://img.shields.io/badge/download-julia-brightgreen.svg" alt="Source code"/></a> <a href="https://nbviewer.jupyter.org/github/AP6YC/AdaptiveResonance.jl/blob/gh-pages/dev/examples/adaptive_resonance/options.ipynb"><img src="https://img.shields.io/badge/show-nbviewer-579ACA.svg" alt="notebook"/></a> <img src="https://img.shields.io/badge/julia-1.6.0-blue.svg" alt="compat"/> <a href="https://github.com/AP6YC"><img src="https://img.shields.io/badge/Author-Sasha%20Petrenko-blue" alt="Author"/></a> <img src="https://img.shields.io/date/1638403200" alt="Update time"/></p><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The <code>AdaptiveResonance.jl</code> package has several ways of handling options for ART modules. These methods are meant to give maximum flexibility to the user for sharing and interpreting options, which themselves vary between each module.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>For more info on options in ART modules, see the guide in the docs on <a href="../../../man/guide/#art_options">ART options</a>.</p></div></div><h2 id="ART-Options"><a class="docs-heading-anchor" href="#ART-Options">ART Options</a><a id="ART-Options-1"></a><a class="docs-heading-anchor-permalink" href="#ART-Options" title="Permalink"></a></h2><p>To get a feel for the ART options system, we will inspect different options and their instantiation methods.</p><h3 id="Inspection"><a class="docs-heading-anchor" href="#Inspection">Inspection</a><a id="Inspection-1"></a><a class="docs-heading-anchor-permalink" href="#Inspection" title="Permalink"></a></h3><p>First, we load <code>AdaptiveResonance</code>:</p><pre><code class="language-julia hljs">using AdaptiveResonance</code></pre><p>Every ART module has a default constructor, which can be instantiated in the usual way:</p><pre><code class="language-julia hljs"># Create a FuzzyART module with default options
my_fuzzyart = FuzzyART()
typeof(my_fuzzyart)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FuzzyART</code></pre><p>Within every ART module is a <a href="https://github.com/mauro3/Parameters.jl">Parameters.jl</a> struct named <code>opts</code> containing the options for the module</p><pre><code class="language-julia hljs"># Check the FuzzyART options
my_fuzzyart.opts</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">opts_FuzzyART
  rho: Float64 0.6
  alpha: Float64 0.001
  beta: Float64 1.0
  gamma: Float64 3.0
  gamma_ref: Float64 1.0
  display: Bool true
  max_epochs: Int64 1
  gamma_normalization: Bool false
</code></pre><p>Note that the options here have the type <code>opts_FuzzyART</code>. This nomenclature is used throughout the module to indicate an options type associated with an ART module. For example, the options for a DDVFA module are <code>opts_DDVFA</code>:</p><pre><code class="language-julia hljs"># Create a DDVFA module and check the type of the options
my_ddvfa = DDVFA()
typeof(my_ddvfa.opts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">opts_DDVFA</code></pre><p>In fact, we can create an instance of these options with a default constructor:</p><pre><code class="language-julia hljs"># Create a separate options struct
my_fuzzyart_opts = opts_FuzzyART()</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">opts_FuzzyART
  rho: Float64 0.6
  alpha: Float64 0.001
  beta: Float64 1.0
  gamma: Float64 3.0
  gamma_ref: Float64 1.0
  display: Bool true
  max_epochs: Int64 1
  gamma_normalization: Bool false
</code></pre><p>In addition to the default constructor, we can construct ART modules by instantiating these options and passing them to the module during construction:</p><pre><code class="language-julia hljs"># Instantiate an ART module by passing our options
my_fuzzyart = FuzzyART(my_fuzzyart_opts)
my_other_fuzzyart = FuzzyART(my_fuzzyart_opts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FuzzyART(opts_FuzzyART
  rho: Float64 0.6
  alpha: Float64 0.001
  beta: Float64 1.0
  gamma: Float64 3.0
  gamma_ref: Float64 1.0
  display: Bool true
  max_epochs: Int64 1
  gamma_normalization: Bool false
, DataConfig(false, Float64[], Float64[], 0, 0), 0.0, Int64[], Float64[], Float64[], Matrix{Float64}(undef, 0, 0), Int64[], 0, 0)</code></pre><h3 id="Specifying-Options"><a class="docs-heading-anchor" href="#Specifying-Options">Specifying Options</a><a id="Specifying-Options-1"></a><a class="docs-heading-anchor-permalink" href="#Specifying-Options" title="Permalink"></a></h3><p>Now to the good stuff: because of the behavior of the <code>Parameters.jl</code> type, each option has a default value that we can modify during instantiation with keyword arguments:</p><pre><code class="language-julia hljs"># Change some of the default FuzzyART options
my_fuzzyart_opts = opts_FuzzyART(
    rho=0.6,
    gamma_normalization=true
)
my_fuzzyart = FuzzyART(my_fuzzyart_opts)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FuzzyART(opts_FuzzyART
  rho: Float64 0.6
  alpha: Float64 0.001
  beta: Float64 1.0
  gamma: Float64 3.0
  gamma_ref: Float64 1.0
  display: Bool true
  max_epochs: Int64 1
  gamma_normalization: Bool true
, DataConfig(false, Float64[], Float64[], 0, 0), 0.0, Int64[], Float64[], Float64[], Matrix{Float64}(undef, 0, 0), Int64[], 0, 0)</code></pre><p>As some syntactic sugar, we can pass these keyword arguments directly to the module during instantiation if we have no need to share option structs:</p><pre><code class="language-julia hljs"># Pass these keyword arguments to the module directly
my_fuzzyart = FuzzyART(
    rho=0.6,
    gamma_normalization=true
)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FuzzyART(opts_FuzzyART
  rho: Float64 0.6
  alpha: Float64 0.001
  beta: Float64 1.0
  gamma: Float64 3.0
  gamma_ref: Float64 1.0
  display: Bool true
  max_epochs: Int64 1
  gamma_normalization: Bool true
, DataConfig(false, Float64[], Float64[], 0, 0), 0.0, Int64[], Float64[], Float64[], Matrix{Float64}(undef, 0, 0), Int64[], 0, 0)</code></pre><p>Before training, we can also instantiate the model and alter the options afterward:</p><pre><code class="language-julia hljs">my_fuzzyart = FuzzyART()
my_fuzzyart.opts.rho=0.6</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">0.6</code></pre><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>All ART modules are designed to use this options struct internally when the parameters are needed. It is possible to change these parameters in the middle of training and evaluation, but some algorithmic instability may occur.</p></div></div><h2 id="Comparison"><a class="docs-heading-anchor" href="#Comparison">Comparison</a><a id="Comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Comparison" title="Permalink"></a></h2><p>To see the effect that changing these parameters has on the modules, we can train and test them side-by-side.</p><p>We begin with importing AdaptiveResonance for the ART modules and MLDatasets for some data utilities.</p><pre><code class="language-julia hljs">using MLDatasets        # Iris dataset
using MLDataUtils       # Shuffling and splitting
using Printf            # Formatted number printing
using MultivariateStats # Principal component analysis (PCA)
using Plots             # Plotting frontend</code></pre><p>We will download the Iris dataset for its small size and benchmark use for clustering algorithms.</p><pre><code class="language- hljs">Iris.download(i_accept_the_terms_of_use=true)
features, labels = Iris.features(), Iris.labels()</code></pre><p>Because the MLDatasets package gives us Iris labels as strings, we will use the <code>MLDataUtils.convertlabel</code> method with the <code>MLLabelUtils.LabelEnc.Indices</code> type to get a list of integers representing each class:</p><pre><code class="language- hljs">labels = convertlabel(LabelEnc.Indices{Int}, labels)
unique(labels)</code></pre><p>Next, we will create a train/test split with the <code>MLDataUtils.stratifiedobs</code> utility:</p><pre><code class="language- hljs">(X_train, y_train), (X_test, y_test) = stratifiedobs((features, labels))</code></pre><p>Now we can create several FuzzyART modules with different options.</p><pre><code class="language-julia hljs"># Create two FuzzyARTs with different vigilance values and suppressing logging messages
rho_1 = 0.5
rho_2 = 0.7
my_fuzzyart_1 = FuzzyART(rho=rho_1, display=false)
my_fuzzyart_2 = FuzzyART(rho=rho_2, display=false)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">FuzzyART(opts_FuzzyART
  rho: Float64 0.7
  alpha: Float64 0.001
  beta: Float64 1.0
  gamma: Float64 3.0
  gamma_ref: Float64 1.0
  display: Bool false
  max_epochs: Int64 1
  gamma_normalization: Bool false
, DataConfig(false, Float64[], Float64[], 0, 0), 0.0, Int64[], Float64[], Float64[], Matrix{Float64}(undef, 0, 0), Int64[], 0, 0)</code></pre><p>Here, we will train these FuzzyART modules in simple supervised mode by passing the supervised labels as a keyword argument:</p><pre><code class="language- hljs"># Train in simple supervised mode by passing the labels as a keyword argument.
y_hat_train_1 = train!(my_fuzzyart_1, X_train, y=y_train)
y_hat_train_2 = train!(my_fuzzyart_2, X_train, y=y_train)</code></pre><p>We then classify the test data with both modules:</p><pre><code class="language- hljs">y_hat_1 = AdaptiveResonance.classify(my_fuzzyart_1, X_test, get_bmu=true)
y_hat_2 = AdaptiveResonance.classify(my_fuzzyart_2, X_test, get_bmu=true)

# Check the shape and type of the output labels
println(&quot;FuzzyART 1 labels: &quot;,  size(y_hat_1), &quot; &quot;, typeof(y_hat_1))
println(&quot;FuzzyART 2 labels: &quot;,  size(y_hat_2), &quot; &quot;, typeof(y_hat_2))

# Calculate the performance on the test data
perf_test_1 = performance(y_hat_1, y_test)
perf_test_2 = performance(y_hat_2, y_test)

# Format each performance number for comparison
@printf &quot;Testing performance rho=%.1f: %.4f\n&quot; rho_1 perf_test_1
@printf &quot;Testing performance rho=%.1f: %.4f\n&quot; rho_2 perf_test_2</code></pre><p>In addition to having different performances, we can see that there is a subsequent trade-off in the number of categories used:</p><pre><code class="language-julia hljs"># Print the number of categories for each vigilance parameter
@printf &quot;Number of categories rho=%.1f: %i\n&quot; rho_1 my_fuzzyart_1.n_categories
@printf &quot;Number of categories rho=%.1f: %i\n&quot; rho_2 my_fuzzyart_2.n_categories</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Number of categories rho=0.5: 0
Number of categories rho=0.7: 0</code></pre><p>The variation between vigilance parameter, number of categories created during learning, and testing performance/generalization is a central theme in ART-based algorithms.</p><h2 id="Visualization"><a class="docs-heading-anchor" href="#Visualization">Visualization</a><a id="Visualization-1"></a><a class="docs-heading-anchor-permalink" href="#Visualization" title="Permalink"></a></h2><p>Now, to visualize how the two models differ in how they partition the data, we can use principal component analysis (PCA) to compress to two plotting dimensions. PCA is a method to represent a dataset in a different number of dimensions while preserving the relative separation between datapoints. Though most datasets are not able to be effectively transformed down to two dimensions, this technique is useful to get a general sense of how well separated the classes are and how well your algorithm classifies them.</p><pre><code class="language- hljs"># Train a PCA model to visually separate the features in two dimensions.
M = fit(PCA, features; maxoutdim=2)

# Apply the PCA model to the testing set
X_test_pca = transform(M, X_test)</code></pre><p>We can now plot the PCA&#39;ed test set and label them according to the two FuzzyART&#39;s We will do so by creating a function for the subplots first as they will share the same format, and we dare not duplicate code. Then, we will plot those subplots side-by-side.</p><pre><code class="language- hljs"># Create a function for our subplots
function fuzzyart_scatter(data, labels, rho)
    p = scatter(
        data[1, :],             # PCA dimension 1
        data[2, :],             # PCA dimension 2
        group=labels,           # labels belonging to each point
        markersize=8,           # size of scatter points
        xlims = [-4, 4],        # manually set the x-limits
        title=(@sprintf &quot;FuzzyART \$\\rho\$ = %.1f&quot; rho),  # formatted title
    )
    return p
end

# Create the two scatterplot objects
p1 = fuzzyart_scatter(X_test_pca, y_hat_1, rho_1)
p2 = fuzzyart_scatter(X_test_pca, y_hat_2, rho_2)

# Plot the two scatterplots together
plot(
    p1, p2,                 # scatterplot objects
    layout = (1, 2),        # plot side-by-side
    ##layout = [a, b],        # plot side-by-side
    legend = false,         # no legend
    xtickfontsize = 12,     # x-tick size
    ytickfontsize = 12,     # y-tick size
    xlabel = &quot;\$PCA_1\$&quot;,   # x-label
    ylabel = &quot;\$PCA_2\$&quot;,   # y-label
    dpi = 300,              # Set the dots-per-inch
)</code></pre><p>We can see that the two different vigilance values result in similar resutls on the whole, though they differ in how they classify certain samples that straddle the border between</p><pre><code class="language- hljs">png(&quot;assets/options-cover&quot;) #hide</code></pre><hr/><p><em>This page was generated using <a href="https://github.com/johnnychen94/DemoCards.jl">DemoCards.jl</a> and <a href="https://github.com/fredrikekre/Literate.jl">Literate.jl</a>.</em></p></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.17 on <span class="colophon-date" title="Thursday 12 May 2022 22:30">Thursday 12 May 2022</span>. Using Julia version 1.6.6.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
